<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>평가자 상세 정보</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <link rel="stylesheet" href="evaluator_styles.css">
    <script src="evaluator_script.js" defer></script>
</head>
<body>
  <div class="tab">
    <button class="tablink" onclick="openTab('ds')">DS</button>
    <button class="tablink" onclick="openTab('sql')">SQL</button>
  </div>
  <div id="ds" class="tabcontent">
    <div class="subtab">
      <button class="subtablink" onclick="openSubTab('dsResult', 'ds', event)">결과</button>
      <button class="subtablink" onclick="openSubTab('dsCode', 'ds', event)">코드</button>
      <button class="subtablink" onclick="openSubTab('dsCheating', 'ds', event)">치팅</button>
    </div>

      <div id="dsResult" class="subtabcontent">
        
    <div class="score-summary">
        <div class="total-score">
          <h3>Competency Score</h3>
          <div class="score-circle">
            <span class="score-value">85</span>
            <span class="score-max">/100</span>
          </div>
        </div>
        <div class="individual-scores">
          <h3>Skill</h3>
          <div class="score-bar">
            <div class="score-label">Preprocessing</div>
            <div class="score-progress" style="width: 85.7%;">
              <span class="score-text">30/35</span>
            </div>
          </div>
          <div class="score-bar">
            <div class="score-label">Feature scaling</div>
            <div class="score-progress" style="width: 80%;">
              <span class="score-text">28/35</span>
            </div>
          </div>
          <div class="score-bar">
            <div class="score-label">Visualization</div>
            <div class="score-progress" style="width: 90%;">
              <span class="score-text">27/30</span>
            </div>
          </div>
        </div>
    </div>
        <h2>DS 점수 분포 및 평가자 위치</h2>
        <div class="chart-container">
          <canvas id="dsScoreDistributionChart"></canvas>
        </div>
        
        <h2>스킬 분포 및 평가자 위치</h2>

        <!-- 첫 번째 스킬 그래프 -->
        <div class="graph" id="graph1">
          <h3>Preprocessing 점수 분포</h3>
          <canvas id="skillScoreDistributionChart_1"></canvas>
        </div>
      
        <!-- 두 번째 스킬 그래프 -->
        <div class="graph" id="graph2" style="display: none;">
          <h3>Feature scaling 점수 분포</h3>
          <canvas id="skillScoreDistributionChart_2"></canvas>
        </div>
      
        <!-- 세 번째 스킬 그래프 -->
        <div class="graph" id="graph3" style="display: none;">
          <h3>Visualization 점수 분포</h3>
          <canvas id="skillScoreDistributionChart_3"></canvas>
        </div>
        
        <button id="prevGraph" disabled>이전</button>
        <button id="nextGraph">다음</button>

        <h2>DS Competency comment</h2>
        <p id="dsCompetencyDescription"></p>
  
        <h2>DS Skill comment</h2>
        <ul id="dsCompetencyComments"></ul>
      </div>

      <div id="dsCode" class="subtabcontent">
          <div class="static-analysis">
            <h4>정적 분석 지표</h4>
            <div class="metrics-grid">
              <div class="metric">
                <span class="metric-label">DUPLICATIONS</span>
                <span class="metric-value" style="--percentage: 15%;">15%</span>
              </div>
              <div class="metric">
                <span class="metric-label">CYCLOMATIC_COMPLEXITY</span>
                <span class="metric-value">7</span>
              </div>
              <div class="metric">
                <span class="metric-label">BUGS</span>
                <span class="metric-value">3</span>
              </div>
              <div class="metric">
                <span class="metric-label">CODING_STYLE</span>
                <span class="metric-value" style="--percentage: 85%;">85%</span>
              </div>
              <div class="metric">
                <span class="metric-label">CODE SMELL</span>
                <span class="metric-value">5</span>
              </div>
            </div>
          </div>
          <pre><code id="codeEditor" class="python"></code></pre>
          <h3>채점 결과</h3>
          <div id="scoringResult">
            <p>TestCase #1 >>> PASS ✔️</p>
            <p>TestCase #2 >>> PASS ✔️</p>
            <p>TestCase #3 >>> PASS ✔️</p>
            <p>TestCase #4 >>> PASS ✔️</p>
            <p>TestCase #5 >>> PASS ✔️</p>
            <p>TestCase #6 >>> PASS ✔️</p>
          </div>
      

        <div class="sidebar">
          <div class="tags">
            <div class="tag" data-tag="Preprocessing">Preprocessing</div>
            <div class="tag" data-tag="model prediction and evaluation">model prediction and evaluation</div>
            <div class="tag" data-tag="Visualization">Visualization</div>
          </div>
          <div class="problem-content">
            <h4>문제</h4>
            <p>당신은 영화 제작 회사의 데이터 분석 팀에 속해 있습니다. 당신의 임무는 다양한 특성을 기반으로 영화의 박스오피스 수익을 예측하는 모델을 구축하는 것입니다. 제공된 영화 메타데이터를
              사용하여 회귀 모델을 만들고 그 성능을 평가하세요.</p>
          </div>
          <div class="guideline-content">
            <h4>지침</h4>
            <p>모든 코드는 evaluate_model() 함수에 작성하세요. 다음 순서를 따라 코드를 작성하세요:</p>
            <ol>
              <li>
                <strong>[Step.1] 데이터 로드 및 전처리</strong>
                <ul>
                  <li>Pandas 라이브러리를 사용하여 './data.csv' 파일을 읽어 DataFrame 변수인 data에 저장하세요.</li>
                  <li>결측값이 있는 행을 제거하여 데이터의 완전성을 유지하세요.</li>
                </ul>
              </li>
              <li>
                <strong>[Step.2] 훈련 세트와 테스트 세트 분할</strong>
                <ul>
                  <li>선택된 특성과 목표 변수를 사용하여 데이터를 훈련 세트(80%)와 테스트 세트(20%)로 분할하세요.</li>
                  <li>random_state는 42로 설정하세요.</li>
                </ul>
              </li>
              <li>
                <strong>[Step.3] 특성 스케일링 및 선택</strong>
                <ul>
                  <li>StandardScaler를 사용하여 특성을 스케일링하세요.</li>
                  <li>SelectKBest와 f_regression을 사용하여 상위 2개의 가장 중요한 특성을 선택하여 selected_features 변수에 리스트로 저장하세요.</li>
                </ul>
              </li>
              <li>
                <strong>[Step.4] 모델 초기화 및 학습</strong>
                <ul>
                  <li>여러 회귀 모델(Random Forest, Linear Regression, Ridge Regression, Lasso Regression)을 정의하고 초기화하세요.
                  </li>
                  <li>각 모델을 훈련 데이터에 대해 학습시키세요.</li>
                  <li>가장 적합한 모델명을 best_model_name 변수에 저장하세요.</li>
                </ul>
              </li>
              <li>
                <strong>[Step.5] 모델 예측 및 평가</strong>
                <ul>
                  <li>각 모델을 사용하여 테스트 데이터에 대한 예측을 수행합니다.</li>
                  <li>예측 결과와 실제 결과 간의 MSE와 R2 점수를 계산하여 model_scores 변수에 리스트로 저장하세요.</li>
                  <li>MSE를 기준으로 가장 성능이 좋은 모델을 선택하고, 해당 모델의 MSE와 R2 점수를 출력하세요.</li>
                </ul>
              </li>
              <li>
                <strong>[Step.6] 결과 시각화</strong>
                <ul>
                  <li>하나의 차트에 모든 플롯을 포함하여 작성하세요 (figsize=(10, 6)).</li>
                  <li>실제 수익(x축)과 예측 수익(y축)을 산점도로 표시하세요 (투명도 50%).</li>
                  <li>실제 수익과 예측 수익이 일치하는 이상적인 라인을 굵기가 2인 빨간색 점선으로 표시하세요.</li>
                  <li>그래프 제목을 'Actual vs Predicted Box Office Revenue\nusing {best_model_name}'로 설정하세요.</li>
                </ul>
              </li>
            </ol>
          </div>
        </div>
      </div>

    
    <div id="dsCheating" class="subtabcontent">
      <div class="time-info">
        <h3>소요 시간</h3>
        <div class="time-bar">
          <div class="time-progress" id="dsTimeProgress">
            <span class="time-text">110분 / 120분</span>
          </div>
        </div>

        <div id="chartTab">
          <h4>타임라인 그래프</h4>
          <canvas id="ganttChart"></canvas>
        </div>

        <div id="listTab">
          <h4>부정행위 상세</h4>
          <table id="suspiciousActivitiesTable">
            <thead>
              <tr>
                <th>시간</th>
                <th>문제 번호</th>
                <th>활동 유형</th>
                <th>영상 확인</th>
              </tr>
            </thead>
            <tbody>
              <!-- Table body will be populated by JavaScript -->
            </tbody>
          </table>
        </div>
      </div>
  </div>
  </div>
  
  <div id="sql" class="tabcontent">
    <div class="subtab">
      <button class="subtablink" onclick="openSubTab('sqlResult', 'sql', event)">결과</button>
      <button class="subtablink" onclick="openSubTab('sqlCode', 'sql',event)">코드</button>
      <button class="subtablink" onclick="openSubTab('sqlCheating', 'sql',event)">치팅</button>
    </div>

    <div id="sqlResult" class="subtabcontent">
    <div class="score-summary">
      <div class="total-score">
        <h3>Competency Score</h3>
        <div class="score-circle_sql">
          <span class="score-value">70</span>
          <span class="score-max">/100</span>
        </div>
      </div>
      <div class="individual-scores">
        <h3>Skill</h3>
        <div class="score-bar">
          <div class="score-label">Data Retrieval</div>
          <div class="score-progress" style="width: 42.9%;">
            <span class="score-text">15/35</span>
          </div>
        </div>
        <div class="score-bar">
          <div class="score-label">Data Filtering</div>
          <div class="score-progress" style="width: 85.7%;">
            <span class="score-text">30/35</span>
          </div>
        </div>
        <div class="score-bar">
          <div class="score-label">Data Joining</div>
          <div class="score-progress" style="width: 66.7%;">
            <span class="score-text">20/30</span>
          </div>
        </div>
      </div>
    </div>
    <h2>SQL 점수 분포 및 평가자 위치</h2>
    <div class="chart-container">
      <canvas id="sqlScoreDistributionChart"></canvas>
    </div>
    <h2>SQL Competency comment</h2>
    <p id="sqlCompetencyDescription"></p>

    <h2>SQL Skill comment</h2>
    <ul id="sqlCompetencyComments"></ul>

    <div id="sqlCode" class="subtabcontent">
      <h3>SQL 코드</h3>
      <pre><code>
      </code></pre>
    </div>



    <div id="sqlCheating" class="subtabcontent">
    <div class="time-info">
      <h3>소요 시간</h3>
      <div class="time-bar">
        <div class="time-progress" id="sqlTimeProgress">
          <span class="time-text">100분 / 120분</span>
        </div>
      </div>

      <div id="sqlChartTab">
        <h4>타임라인 그래프</h4>
        <canvas id="sqlGanttChart"></canvas>
      </div>

      <div id="sqlListTab">
        <h4>부정행위 상세</h4>
        <div class="scrollable-table">
          <table id="sqlSuspiciousActivitiesTable">
            <thead>
              <tr>
                <th>시간</th>
                <th>문제 번호</th>
                <th>활동 유형</th>
                <th>영상 확인</th>
              </tr>
            </thead>
            <tbody>
              <!-- 테이블 내용은 JavaScript로 채워집니다 -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
    </div>
  </div>
  </div>

  <script>
document.addEventListener('DOMContentLoaded', function () {
    let currentGraph = 1;
    const totalGraphs = 3;

    // 그래프 전환 함수
    function showGraph(graphIndex) {
        for (let i = 1; i <= totalGraphs; i++) {
            const graph = document.getElementById(`graph${i}`);
            if (i === graphIndex) {
                graph.style.display = 'block';
            } else {
                graph.style.display = 'none';
            }
        }

        // 이전/다음 버튼 활성화/비활성화 처리
        document.getElementById('prevGraph').disabled = graphIndex === 1;
        document.getElementById('nextGraph').disabled = graphIndex === totalGraphs;
    }

    // 초기 상태로 첫 번째 그래프 표시
    showGraph(currentGraph);

    // 이전 버튼 클릭 이벤트
    document.getElementById('prevGraph').addEventListener('click', function () {
        if (currentGraph > 1) {
            currentGraph--;
            showGraph(currentGraph);
        }
    });

    // 다음 버튼 클릭 이벤트
    document.getElementById('nextGraph').addEventListener('click', function () {
        if (currentGraph < totalGraphs) {
            currentGraph++;
            showGraph(currentGraph);
        }
    });

    // Chart.js로 각 스킬의 점수 분포 차트 생성
    function createSkillScoreDistributionChart(canvasId, label, data, evaluatorScore) {
        const ctx = document.getElementById(canvasId);
        const labels = ['0-20', '21-40', '41-60', '61-80', '81-100'];
        const scoreIndex = Math.floor(evaluatorScore / 20);

        new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: `${label} 점수 분포`,
                        data: data,
                        borderColor: 'rgba(75, 192, 192, 1)',
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        borderWidth: 2,
                        pointRadius: 5,
                        pointBackgroundColor: 'rgba(75, 192, 192, 1)',
                        fill: true,
                    },
                    {
                        label: '평가자 점수',
                        data: labels.map((_, index) => (index === scoreIndex ? evaluatorScore : null)),
                        borderColor: 'rgba(255,99,132,1)',
                        backgroundColor: 'rgba(255,99,132,1)',
                        borderWidth: 2,
                        pointRadius: 7,
                        pointStyle: 'rectRot',
                    },
                ],
            },
            options: {
                responsive: true,
                animation: false,
                scales: {
                    y: { beginAtZero: true },
                    x: { title: { display: true, text: '점수 구간' } },
                },
                plugins: {
                    legend: { display: true }
                },
            },
        });
    }

    // 각 스킬에 대한 차트 생성
    createSkillScoreDistributionChart('skillScoreDistributionChart_1', 'Preprocessing', [5, 10, 15, 20, 10], 75);
    createSkillScoreDistributionChart('skillScoreDistributionChart_2', 'Feature scaling', [8, 12, 18, 22, 7], 65);
    createSkillScoreDistributionChart('skillScoreDistributionChart_3', 'Visualization', [6, 9, 14, 19, 12], 85);
});
  </script>
</body>

</html>
