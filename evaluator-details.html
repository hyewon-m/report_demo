<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>평가자 상세 정보</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      line-height: 1.6;
      color: #333;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f0f4f8;
    }

    .container {
      background-color: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    }

    h1,
    h2 {
      color: #0f3a68;
      border-bottom: 2px solid #0f3a68;
      padding-bottom: 10px;
    }

    .tab-container {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }

    .tab-button {
      background-color: #0f3a68;
      color: white;
      border: none;
      padding: 10px 20px;
      margin: 0 5px;
      cursor: pointer;
      border-radius: 5px;
    }

    .tab-button.active {
      background-color: #4CAF50;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .score-summary {
      display: flex;
      justify-content: space-between;
      margin-bottom: 30px;
    }

    .total-score,
    .individual-scores {
      flex: 1;
    }

    .score-circle {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      background-color: #4CAF50;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: white;
      margin: 0 auto;
    }

    .score-value {
      font-size: 48px;
      font-weight: bold;
    }

    .score-max {
      font-size: 24px;
    }

    .score-bar {
      margin-bottom: 15px;
    }

    .score-label {
      margin-bottom: 5px;
      font-weight: bold;
    }

    .score-progress {
      height: 30px;
      background-color: #4CAF50;
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding-right: 10px;
      color: white;
      font-weight: bold;
    }

    .time-info {
      margin-top: 30px;
    }

    .time-bar {
      height: 30px;
      background-color: #e0e0e0;
      border-radius: 15px;
      overflow: hidden;
    }

    .time-progress {
      height: 100%;
      background-color: #2196F3;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      transition: width 1s ease-in-out;
    }

    .chart-container {
      margin-top: 20px;
      height: 300px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1 id="evaluatorName">평가자 상세 정보</h1>

    <div class="tab-container">
      <button class="tab-button active" onclick="openTab('ds')">DS</button>
      <button class="tab-button" onclick="openTab('sql')">SQL</button>
    </div>

    <div id="ds" class="tab-content active">
      <h2>DS 점수 분포 및 평가자 위치</h2>
      <div class="chart-container">
        <canvas id="dsScoreDistributionChart"></canvas>
      </div>
      <h2>DS Level 1 Result</h2>
      <div class="score-summary">
        <div class="total-score">
          <h3>Conpetency Score</h3>
          <div class="score-circle">
            <span class="score-value">85</span>
            <span class="score-max">/100</span>
          </div>
        </div>
        <div class="individual-scores">
          <h3>Skill</h3>
          <div class="score-bar">
            <div class="score-label">Preprocessing</div>
            <div class="score-progress" style="width: 85.7%;">
              <span class="score-text">30/35</span>
            </div>
          </div>
          <div class="score-bar">
            <div class="score-label">Feature scaling</div>
            <div class="score-progress" style="width: 80%;">
              <span class="score-text">28/35</span>
            </div>
          </div>
          <div class="score-bar">
            <div class="score-label">Visualization</div>
            <div class="score-progress" style="width: 90%;">
              <span class="score-text">27/30</span>
            </div>
          </div>
        </div>
      </div>
      <div class="time-info">
        <h3>소요 시간</h3>
        <div class="time-bar">
          <div class="time-progress" id="dsTimeProgress">
            <span class="time-text">110분 / 120분</span>
          </div>
        </div>
      </div>
      <canvas id="ganttChart"></canvas>
      <h2>DS Competency comment</h2>
      <p id="dsCompetencyDescription"></p>

      <h2>DS Skill comment</h2>
      <ul id="dsCompetencyComments"></ul>
    </div>

    <div id="sql" class="tab-content">
      <h2>SQL 점수 분포 및 평가자 위치</h2>
      <div class="chart-container">
        <canvas id="sqlScoreDistributionChart"></canvas>
      </div>
      <h2>SQL Level 2 Result</h2>
      <div class="score-summary">
        <div class="total-score">
          <h3>Conpetency Score</h3>
          <div class="score-circle">
            <span class="score-value">70</span>
            <span class="score-max">/100</span>
          </div>
        </div>
        <div class="individual-scores">
          <h3>Skill</h3>
          <div class="score-bar">
            <div class="score-label">Data Retrieval</div>
            <div class="score-progress" style="width: 42.9%;">
              <span class="score-text">15/35</span>
            </div>
          </div>
          <div class="score-bar">
            <div class="score-label">Data Filtering</div>
            <div class="score-progress" style="width: 85.7%;">
              <span class="score-text">30/35</span>
            </div>
          </div>
          <div class="score-bar">
            <div class="score-label">Data Joining</div>
            <div class="score-progress" style="width: 66.7%;">
              <span class="score-text">20/30</span>
            </div>
          </div>
        </div>
      </div>
      <div class="time-info">
        <h3>소요 시간</h3>
        <div class="time-bar">
          <div class="time-progress" id="sqlTimeProgress">
            <span class="time-text">100분 / 120분</span>
          </div>
        </div>
      </div>
      <h2>SQL Competency comment</h2>
      <p id="sqlCompetencyDescription"></p>

      <h2>SQL Skill comment</h2>
      <ul id="sqlCompetencyComments"></ul>
    </div>
  </div>

  <script>
    function openTab(tabName) {
      var tabContents = document.getElementsByClassName("tab-content");
      var tabButtons = document.getElementsByClassName("tab-button");

      for (var i = 0; i < tabContents.length; i++) {
        tabContents[i].style.display = "none";
        tabButtons[i].classList.remove("active");
      }

      document.getElementById(tabName).style.display = "block";
      event.currentTarget.classList.add("active");

      runAnimations(tabName);
    }

    function runAnimations(tabName) {
      document.querySelectorAll('.time-progress').forEach(el => {
        el.style.width = '0%';
      });

      setTimeout(() => {
        if (tabName === 'ds') {
          document.getElementById('dsTimeProgress').style.width = '91.7%';
        } else if (tabName === 'sql') {
          document.getElementById('sqlTimeProgress').style.width = '83.3%';
        }
      }, 100);
    }

    function createScoreDistributionChart(canvasId, label, data, score) {
      const ctx = document.getElementById(canvasId).getContext('2d');
      const labels = ['0-20', '21-40', '41-60', '61-80', '81-100'];
      const scoreIndex = Math.floor(score / 20);

      new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: label + ' 점수 분포',
            data: data,
            borderColor: 'rgba(75, 192, 192, 1)',
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            borderWidth: 2,
            pointRadius: 5,
            pointBackgroundColor: 'rgba(75, 192, 192, 1)',
            fill: true
          }, {
            label: '평가자 점수',
            data: labels.map((_, index) => index === scoreIndex ? score : null),
            borderColor: 'rgba(255, 99, 132, 1)',
            backgroundColor: 'rgba(255, 99, 132, 1)',
            borderWidth: 2,
            pointRadius: 7,
            pointStyle: 'triangle'
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true,
              title: { display: true, text: '인원 수' }
            },
            x: {
              title: { display: true, text: '점수 구간' }
            }
          },
          plugins: {
            legend: { display: true },
            title: { display: true, text: label + ' 평가 참가자 점수 분포' },
            tooltip: {
              callbacks: {
                label: function (context) {
                  if (context.dataset.label === '평가자 점수') {
                    return `평가자 점수: ${score}`;
                  }
                  return `${context.dataset.label}: ${context.parsed.y}명`;
                }
              }
            }
          }
        }
      });
    }

    function getCompetencyDescription(score, field) {
      if (field === 'DS') {
        if (score >= 80) return "데이터 사이언스 분야에서 뛰어난 역량을 보여주고 있습니다. 고급 기술을 적용할 수 있는 수준입니다.";
        else if (score >= 60) return "데이터 사이언스의 기본 개념을 잘 이해하고 있으며, 실무에 적용할 수 있는 수준입니다.";
        else return "데이터 사이언스의 기초 개념을 이해하고 있지만, 더 많은 학습과 실습이 필요합니다.";
      } else if (field === 'SQL') {
        if (score >= 80) return "SQL을 능숙하게 다루며, 복잡한 쿼리를 작성하고 최적화할 수 있는 수준입니다.";
        else if (score >= 60) return "SQL의 기본 문법을 이해하고 일반적인 데이터베이스 작업을 수행할 수 있는 수준입니다.";
        else return "SQL의 기초를 이해하고 있지만, 더 복잡한 쿼리 작성 능력을 향상시킬 필요가 있습니다.";
      }
    }

    function getCompetencyComments(scores, field) {
      const comments = [];
      if (field === 'DS') {
        if (scores.preprocessing >= 30) comments.push("데이터 전처리 능력이 우수합니다.");
        else comments.push("데이터 전처리 기술을 더 향상시킬 필요가 있습니다.");

        if (scores.featureScaling >= 28) comments.push("특성 스케일링을 효과적으로 수행할 수 있습니다.");
        else comments.push("특성 스케일링 기법에 대한 추가 학습이 필요합니다.");

        if (scores.visualization >= 27) comments.push("데이터 시각화 능력이 뛰어납니다.");
        else comments.push("데이터 시각화 기술을 더 발전시킬 필요가 있습니다.");
      } else if (field === 'SQL') {
        if (scores.dataRetrieval >= 25) comments.push("데이터 검색 능력이 우수합니다.");
        else comments.push("데이터 검색 쿼리 작성 능력을 향상시킬 필요가 있습니다.");

        if (scores.dataFiltering >= 28) comments.push("데이터 필터링을 효과적으로 수행할 수 있습니다.");
        else comments.push("데이터 필터링 기법에 대한 추가 학습이 필요합니다.");

        if (scores.dataJoining >= 25) comments.push("데이터 조인 능력이 뛰어납니다.");
        else comments.push("데이터 조인 기술을 더 발전시킬 필요가 있습니다.");
      }
      return comments;
    }

    function updateCompetencyInfo() {
      const dsScore = 85;
      const sqlScore = 70;
      const dsScores = { preprocessing: 30, featureScaling: 28, visualization: 27 };
      const sqlScores = { dataRetrieval: 15, dataFiltering: 30, dataJoining: 20 };

      document.getElementById('dsCompetencyDescription').textContent = getCompetencyDescription(dsScore, 'DS');
      document.getElementById('sqlCompetencyDescription').textContent = getCompetencyDescription(sqlScore, 'SQL');

      const dsComments = getCompetencyComments(dsScores, 'DS');
      const sqlComments = getCompetencyComments(sqlScores, 'SQL');

      document.getElementById('dsCompetencyComments').innerHTML = dsComments.map(comment => `<li>${comment}</li>`).join('');
      document.getElementById('sqlCompetencyComments').innerHTML = sqlComments.map(comment => `<li>${comment}</li>`).join('');
    }

    document.addEventListener('DOMContentLoaded', function () {
      const urlParams = new URLSearchParams(window.location.search);
      const evaluatorName = urlParams.get('name') || '평가자';
      document.getElementById('evaluatorName').textContent = evaluatorName + ' 상세 정보';

      createScoreDistributionChart('dsScoreDistributionChart', 'DS', [1, 3, 8, 15, 8], 85);
      createScoreDistributionChart('sqlScoreDistributionChart', 'SQL', [2, 5, 10, 12, 6], 70);

      updateCompetencyInfo();
      runAnimations('ds');
    });

    document.addEventListener('DOMContentLoaded', function () {
      const urlParams = new URLSearchParams(window.location.search);
      const evaluatorName = urlParams.get('name');
      document.getElementById('evaluatorName').textContent = evaluatorName;

    });
    const ganttData = {
      labels: ['문제 1', '문제 2', '문제 3', '문제 4'],
      datasets: [
        {
          label: '문제 풀이',
          data: [
            { x: [0, 25], y: '문제 1' },
            { x: [30, 60], y: '문제 2' },
            { x: [65, 90], y: '문제 3' },
            { x: [95, 110], y: '문제 4' }
          ],
          backgroundColor: 'rgba(75, 192, 192, 0.6)'
        },
        {
          label: '탭 전환',
          data: [
            { x: [15, 17], y: '문제 1' },
            { x: [45, 47], y: '문제 2' },
            { x: [80, 82], y: '문제 3' }
          ],
          backgroundColor: 'rgba(255, 99, 132, 0.6)'
        },
        {
          label: '복사 붙여넣기',
          data: [
            { x: [5, 6], y: '문제 1' },
            { x: [50, 53], y: '문제 2' },
            { x: [67, 70], y: '문제 3' }
          ],
          backgroundColor: '#e4ec9a'
        }
      ]
    };

    // 간트차트 설정
    const ganttConfig = {
      type: 'bar',
      data: ganttData,
      options: {
        indexAxis: 'y',
        scales: {
          x: {
            type: 'linear',
            position: 'top'
          },
          y: {
            title: {
              display: true,
              text: '문제'
            }
          }
        },
        plugins: {
          legend: {
            display: true,
            position: 'bottom'
          }
        }
      }
    };

    // 간트차트 생성
    const ganttCtx = document.getElementById('ganttChart').getContext('2d');
    new Chart(ganttCtx, ganttConfig);
  </script>
</body>

</html>